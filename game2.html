<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°„ç®­éŠæˆ²</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow: hidden;
        }
        
        .game-container {
            position: relative;
            width: 800px;
            max-width: 95%;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            color: white;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #ffcc00, 0 0 20px #ff9900;
            letter-spacing: 2px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(30, 30, 40, 0.8);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .stat-box {
            text-align: center;
            color: white;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #ffcc00;
        }
        
        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        canvas {
            background: #0d1b2a;
            border-radius: 12px;
            display: block;
            margin: 0 auto;
            cursor: crosshair;
        }
        
        .instructions {
            color: #e0e0e0;
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(30, 30, 40, 0.8);
            border-radius: 12px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .instructions p {
            margin: 8px 0;
        }
        
        .highlight {
            color: #ffcc00;
            font-weight: bold;
        }
        
        .power-bar {
            height: 20px;
            background: #333;
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
            position: relative;
        }
        
        .power-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #ff3300, #ffcc00);
            border-radius: 10px;
            transition: width 0.1s;
        }
        
        .power-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 0 0 2px black;
        }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            border-radius: 20px;
            display: none;
        }
        
        .game-over h2 {
            color: #ffcc00;
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
        }
        
        .final-score {
            color: white;
            font-size: 2rem;
            margin-bottom: 30px;
        }
        
        .btn {
            background: linear-gradient(to right, #ff9900, #ff3300);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            letter-spacing: 1px;
            box-shadow: 0 5px 15px rgba(255, 51, 0, 0.4);
            transition: all 0.3s;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 51, 0, 0.6);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
            
            .stat-value {
                font-size: 1.8rem;
            }
            
            .instructions {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ğŸ¹ å°„ç®­å¤§å¸« ğŸ¹</h1>
        </div>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-value" id="score">0</div>
                <div class="stat-label">å¾—åˆ†</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="arrows">5</div>
                <div class="stat-label">å‰©é¤˜ç®­æ•¸</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">å‘½ä¸­ç‡</div>
            </div>
        </div>
        
        <div class="power-bar">
            <div class="power-fill" id="powerFill"></div>
            <div class="power-text" id="powerText">æ‹‰å¼“åŠ›åº¦: 0%</div>
        </div>
        
        <canvas id="gameCanvas" width="760" height="400"></canvas>
        
        <div class="instructions">
            <p>ğŸ¯ <span class="highlight">æŒ‰ä½æ»‘é¼ å·¦éµ</span> æ‹‰å¼“ä¸¦èª¿æ•´åŠ›åº¦</p>
            <p>ğŸ¯ <span class="highlight">é‡‹æ”¾æ»‘é¼ å·¦éµ</span> ç™¼å°„ç®­çŸ¢</p>
            <p>ğŸ¯ å‘½ä¸­é¶å¿ƒç²å¾—<span class="highlight">10åˆ†</span>ï¼æ¯è¼ªæœ‰<span class="highlight">5æ”¯ç®­</span></p>
        </div>
        
        <div class="game-over" id="gameOver">
            <h2>éŠæˆ²çµæŸï¼</h2>
            <div class="final-score">æœ€çµ‚å¾—åˆ†: <span id="finalScore">0</span></div>
            <button class="btn" id="restartBtn">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // éŠæˆ²è®Šæ•¸
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const arrowsElement = document.getElementById('arrows');
        const accuracyElement = document.getElementById('accuracy');
        const powerFill = document.getElementById('powerFill');
        const powerText = document.getElementById('powerText');
        const gameOverScreen = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const restartBtn = document.getElementById('restartBtn');
        
        // éŠæˆ²ç‹€æ…‹
        let score = 0;
        let arrowsLeft = 5; // ä¿®æ”¹ç‚º5æ”¯ç®­
        let hits = 0;
        let gameActive = true;
        let isDragging = false;
        let power = 0;
        let arrow = null;
        let target = null;
        
        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            score = 0;
            arrowsLeft = 5; // ä¿®æ”¹ç‚º5æ”¯ç®­
            hits = 0;
            gameActive = true;
            isDragging = false;
            power = 0;
            arrow = null;
            target = { x: canvas.width - 100, y: canvas.height / 2 };
            
            updateUI();
            gameOverScreen.style.display = 'none';
            draw();
        }
        
        // æ›´æ–°UI
        function updateUI() {
            scoreElement.textContent = score;
            arrowsElement.textContent = arrowsLeft;
            const accuracy = arrowsLeft === 5 ? 0 : Math.round((hits / (5 - arrowsLeft)) * 100); // ä¿®æ”¹ç‚º5æ”¯ç®­
            accuracyElement.textContent = `${accuracy}%`;
        }
        
        // ç¹ªè£½éŠæˆ²å…ƒç´ 
        function draw() {
            // æ¸…é™¤ç•«å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç¹ªè£½èƒŒæ™¯
            drawBackground();
            
            // ç¹ªè£½é¶å­
            drawTarget();
            
            // ç¹ªè£½å¼“
            drawBow();
            
            // ç¹ªè£½ç®­
            if (arrow) {
                drawArrow();
            }
            
            // å¦‚æœéŠæˆ²çµæŸ
            if (!gameActive && arrowsLeft === 0) {
                showGameOver();
            }
        }
        
        // ç¹ªè£½èƒŒæ™¯
        function drawBackground() {
            // å¤©ç©ºæ¼¸å±¤
            const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            skyGradient.addColorStop(0, '#1e3c72');
            skyGradient.addColorStop(1, '#2a5298');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // é›²æœµ
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            drawCloud(100, 80, 30);
            drawCloud(300, 60, 40);
            drawCloud(500, 100, 35);
            drawCloud(650, 70, 25);
            
            // åœ°é¢
            ctx.fillStyle = '#2d5d2d';
            ctx.fillRect(0, canvas.height - 40, canvas.width, 40);
            
            // è‰åœ°ç´°ç¯€
            ctx.fillStyle = '#3d7d3d';
            for (let i = 0; i < 50; i++) {
                const x = Math.random() * canvas.width;
                const height = 10 + Math.random() * 15;
                ctx.fillRect(x, canvas.height - 40, 2, -height);
            }
        }
        
        // ç¹ªè£½é›²æœµ
        function drawCloud(x, y, size) {
            ctx.beginPath();
            ctx.arc(x, y, size, 0, Math.PI * 2);
            ctx.arc(x + size * 0.8, y - size * 0.2, size * 0.8, 0, Math.PI * 2);
            ctx.arc(x + size * 1.5, y, size * 0.9, 0, Math.PI * 2);
            ctx.arc(x + size * 0.8, y + size * 0.2, size * 0.7, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // ç¹ªè£½é¶å­
        function drawTarget() {
            const { x, y } = target;
            const rings = [
                { radius: 80, color: '#f44336' },
                { radius: 65, color: '#ff9800' },
                { radius: 50, color: '#ffeb3b' },
                { radius: 35, color: '#4caf50' },
                { radius: 20, color: '#2196f3' },
                { radius: 8, color: '#9c27b0' }
            ];
            
            // ç¹ªè£½é¶ç’°
            rings.forEach(ring => {
                ctx.beginPath();
                ctx.arc(x, y, ring.radius, 0, Math.PI * 2);
                ctx.fillStyle = ring.color;
                ctx.fill();
            });
            
            // é¶å¿ƒ
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fillStyle = '#ffffff';
            ctx.fill();
            
            // é¶æ¶
            ctx.strokeStyle = '#8B4513';
            ctx.lineWidth = 8;
            ctx.beginPath();
            ctx.moveTo(x - 100, y + 120);
            ctx.lineTo(x + 100, y + 120);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(x, y + 120);
            ctx.lineTo(x, y - 100);
            ctx.stroke();
        }
        
        // ç¹ªè£½å¼“
        function drawBow() {
            const bowX = 80;
            const bowY = canvas.height / 2;
            
            // å¼“èº«
            ctx.strokeStyle = '#8B4513';
            ctx.lineWidth = 12;
            ctx.beginPath();
            ctx.arc(bowX, bowY, 60, -Math.PI/3, Math.PI/3);
            ctx.stroke();
            
            // å¼“å¼¦ï¼ˆæ ¹æ“šæ‹‰å¼“åŠ›åº¦è®ŠåŒ–ï¼‰
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            const pullX = isDragging ? bowX - power * 1.5 : bowX;
            ctx.beginPath();
            ctx.moveTo(pullX, bowY - 50);
            ctx.lineTo(pullX, bowY + 50);
            ctx.stroke();
            
            // æ‰‹æŸ„
            ctx.fillStyle = '#5D4037';
            ctx.fillRect(bowX - 15, bowY - 20, 30, 40);
        }
        
        // ç¹ªè£½ç®­
        function drawArrow() {
            const { x, y, vx, vy } = arrow;
            
            // è¨ˆç®—ç®­çš„è§’åº¦
            const angle = Math.atan2(vy, vx);
            
            // ç®­æ¡¿
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(angle);
            
            // ç®­èº«
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, -2, 40, 4);
            
            // ç®­é ­
            ctx.fillStyle = '#777';
            ctx.beginPath();
            ctx.moveTo(40, -5);
            ctx.lineTo(55, 0);
            ctx.lineTo(40, 5);
            ctx.closePath();
            ctx.fill();
            
            // ç®­ç¾½
            ctx.fillStyle = '#f44336';
            ctx.fillRect(-10, -8, 10, 4);
            ctx.fillRect(-10, 4, 10, 4);
            
            ctx.restore();
        }
        
        // ç™¼å°„ç®­
        function shootArrow() {
            if (!gameActive || arrowsLeft <= 0) return;
            
            const bowX = 80;
            const bowY = canvas.height / 2;
            const targetX = target.x;
            const targetY = target.y;
            
            // è¨ˆç®—ç®­çš„åˆé€Ÿåº¦ï¼ˆåŸºæ–¼æ‹‰å¼“åŠ›åº¦ï¼‰
            const speed = 5 + power * 0.15;
            
            // è¨ˆç®—æ–¹å‘å‘é‡
            const dx = targetX - bowX;
            const dy = targetY - bowY;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            // æ­£è¦åŒ–æ–¹å‘å‘é‡
            const vx = (dx / distance) * speed;
            const vy = (dy / distance) * speed;
            
            // å‰µå»ºç®­ç‰©ä»¶
            arrow = {
                x: bowX,
                y: bowY,
                vx: vx,
                vy: vy,
                gravity: 0.2
            };
            
            // æ¸›å°‘ç®­æ•¸
            arrowsLeft--;
            updateUI();
            
            // é‡ç½®æ‹‰å¼“ç‹€æ…‹
            isDragging = false;
            power = 0;
            updatePowerBar();
            
            // é–‹å§‹å‹•ç•«
            animateArrow();
        }
        
        // ç®­çš„å‹•ç•«
        function animateArrow() {
            if (!arrow) return;
            
            // æ›´æ–°ç®­çš„ä½ç½®
            arrow.x += arrow.vx;
            arrow.y += arrow.vy;
            arrow.vy += arrow.gravity; // é‡åŠ›å½±éŸ¿
            
            // æª¢æŸ¥æ˜¯å¦æ“Šä¸­é¶å­
            if (arrow.x > target.x - 90 && arrow.x < target.x + 90 && 
                arrow.y > target.y - 90 && arrow.y < target.y + 90) {
                
                // è¨ˆç®—è·é›¢é¶å¿ƒçš„è·é›¢
                const dx = arrow.x - target.x;
                const dy = arrow.y - target.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                // æ ¹æ“šè·é›¢è¨ˆç®—å¾—åˆ†ï¼ˆä¿®æ”¹ç‚ºé¶å¿ƒ10åˆ†ï¼‰
                let points = 0;
                if (distance <= 8) points = 10;   // é¶å¿ƒ - 10åˆ†
                else if (distance <= 20) points = 8;
                else if (distance <= 35) points = 6;
                else if (distance <= 50) points = 4;
                else if (distance <= 65) points = 2;
                else if (distance <= 80) points = 1;
                
                if (points > 0) {
                    score += points;
                    hits++;
                    updateUI();
                    
                    // é¡¯ç¤ºå¾—åˆ†å‹•ç•«
                    showScorePopup(arrow.x, arrow.y, points);
                }
                
                // ç§»é™¤ç®­
                arrow = null;
            }
            // æª¢æŸ¥æ˜¯å¦è¶…å‡ºé‚Šç•Œ
            else if (arrow.x > canvas.width || arrow.y > canvas.height || arrow.y < 0) {
                arrow = null;
            }
            
            // é‡æ–°ç¹ªè£½
            draw();
            
            // å¦‚æœç®­é‚„åœ¨é£›è¡Œï¼Œç¹¼çºŒå‹•ç•«
            if (arrow) {
                requestAnimationFrame(animateArrow);
            }
        }
        
        // é¡¯ç¤ºå¾—åˆ†å‹•ç•«
        function showScorePopup(x, y, points) {
            const popup = document.createElement('div');
            popup.textContent = `+${points}`;
            popup.style.position = 'absolute';
            popup.style.left = `${x + canvas.offsetLeft}px`;
            popup.style.top = `${y + canvas.offsetTop}px`;
            popup.style.color = points >= 8 ? '#ffeb3b' : points >= 4 ? '#4caf50' : '#2196f3';
            popup.style.fontSize = '24px';
            popup.style.fontWeight = 'bold';
            popup.style.textShadow = '0 0 5px black';
            popup.style.pointerEvents = 'none';
            popup.style.zIndex = '5';
            popup.style.transition = 'all 1s ease-out';
            
            document.body.appendChild(popup);
            
            // å‹•ç•«æ•ˆæœ
            setTimeout(() => {
                popup.style.transform = 'translateY(-50px)';
                popup.style.opacity = '0';
            }, 10);
            
            // ç§»é™¤å…ƒç´ 
            setTimeout(() => {
                document.body.removeChild(popup);
            }, 1000);
        }
        
        // æ›´æ–°æ‹‰å¼“åŠ›åº¦æ¢
        function updatePowerBar() {
            powerFill.style.width = `${power}%`;
            powerText.textContent = `æ‹‰å¼“åŠ›åº¦: ${Math.round(power)}%`;
        }
        
        // é¡¯ç¤ºéŠæˆ²çµæŸç•«é¢
        function showGameOver() {
            finalScoreElement.textContent = score;
            gameOverScreen.style.display = 'flex';
        }
        
        // äº‹ä»¶ç›£è½å™¨
        canvas.addEventListener('mousedown', (e) => {
            if (!gameActive || arrowsLeft <= 0) return;
            isDragging = true;
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (!isDragging || !gameActive || arrowsLeft <= 0) return;
            
            // è¨ˆç®—æ‹‰å¼“åŠ›åº¦ï¼ˆé™åˆ¶åœ¨0-100%ï¼‰
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const bowX = 80;
            power = Math.min(100, Math.max(0, (bowX - mouseX) * 2));
            updatePowerBar();
        });
        
        canvas.addEventListener('mouseup', () => {
            if (isDragging && gameActive && arrowsLeft > 0) {
                shootArrow();
            }
            isDragging = false;
        });
        
        canvas.addEventListener('mouseleave', () => {
            if (isDragging && gameActive && arrowsLeft > 0) {
                shootArrow();
            }
            isDragging = false;
        });
        
        // è§¸æ§è¨­å‚™æ”¯æ´
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!gameActive || arrowsLeft <= 0) return;
            isDragging = true;
        });
        
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (!isDragging || !gameActive || arrowsLeft <= 0) return;
            
            const rect = canvas.getBoundingClientRect();
            const touchX = e.touches[0].clientX - rect.left;
            const bowX = 80;
            power = Math.min(100, Math.max(0, (bowX - touchX) * 2));
            updatePowerBar();
        });
        
        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            if (isDragging && gameActive && arrowsLeft > 0) {
                shootArrow();
            }
            isDragging = false;
        });
        
        // é‡æ–°é–‹å§‹æŒ‰éˆ•
        restartBtn.addEventListener('click', initGame);
        
        // åˆå§‹åŒ–éŠæˆ²
        initGame();
    </script>
</body>
</html>